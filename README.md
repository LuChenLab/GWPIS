# GWPIS: Geometric Weighted Pathway Interaction Score

GWPIS (Geometric Weighted Pathway Interaction Score) is a framework developed to explore the interaction between SARS-CoV-2 proteins and host immune pathways. The library integrates D-SCRIPT protein-language models (available at https://d-script.readthedocs.io) and weighted pathway activity scores from PROGENy (available at https://saezlab.github.io/progeny/) to quantify how SARS-CoV-2 proteins interact with host immune responses at the pathway level.

## 📦 Required R Version and Packages

### R Version:
- **R version**: 4.0.2 (2020-06-22)

### Required R Packages:
The following packages are required to run the analysis:

- **dplyr** (1.1.3)
- **ggplot2** (3.4.4)
- **reshape2** (1.4.4)
- **tidyr** (1.3.0)
- **igraph** (1.5.1)
- **Matrix** (1.6-1.1)
- **DESeq2** (1.42.0)
- **Mfuzz** (2.48.0)
- **PROGENy** (1.10.0)
- **clusterProfiler** (4.9.0.002)
- **GenomicRanges** (1.52.1)
- **SummarizedExperiment** (1.30.2)
- **e1071** (1.7-4)

You can install the necessary packages with the following commands in R:

```r
install.packages(c("dplyr", "ggplot2", "reshape2", "tidyr", "igraph", "Matrix", "e1071"))
BiocManager::install(c("DESeq2", "Mfuzz", "clusterProfiler", "PROGENy", "GenomicRanges", "SummarizedExperiment"))
```

## 📂 Repository Structure

This repository is organized into three main folders: `data`, `script`, and `analysis`. Below is a breakdown of the files contained in each folder:

### 1. `script` Folder 📝

Contains R scripts used for analysis, including data processing, clustering, and pathway analysis.

- **01_Fig1_Bulk_RNAseq.Rmd**: R Markdown script for processing Bulk RNA-seq data.
- **02_Fig1_Mfuzz.Rmd**: R Markdown script for performing gene clustering using the Mfuzz package.
- **03_Fig1_PROGENy.Rmd**: R Markdown script for conducting pathway analysis of the samples using PROGENy.
- **04_Fig2_GWPIS.Rmd**: R Markdown script for calculating the interaction scores between SARS-CoV-2 proteins and immune pathways using the GWPIS method.

### 2. `data` Folder 🗂️

Contains the data files used in the analysis.

- **01_RawCount.txt**: Raw RNA-seq count data used for Figure 1 (Bulk RNA-seq).
- **04_Predict.tsv**: Protein-protein interaction data generated by the D-SCRIPT method, used for Figure 2 (protein interaction analysis).

### 3. `analysis` Folder 📊

Contains processed analysis results and intermediate data objects.

- **01_ddsres.Rds**: DESeq2 object created using the raw RNA-seq counts.
- **02_cl.Rds/02_df.Rds**: Results of gene clustering using Mfuzz.
- **03_Progeny.Rds**: PROGENy pathway enrichment results.

## 📚 References

1. Sledzieski S, Singh R, Cowen L, Berger B. D-SCRIPT translates genome to phenome with sequence-based, structure-aware, genome-scale predictions of protein-protein interactions. *Cell Syst.* 2021 Oct 20;12(10):969-982.e6. doi: [10.1016/j.cels.2021.08.010](https://doi.org/10.1016/j.cels.2021.08.010). Epub 2021 Oct 9. PMID: 34536380; PMCID: PMC8586911.

2. Schubert M, Klinger B, Klünemann M, Sieber A, Uhlitz F, Sauer S, Garnett MJ, Blüthgen N, Saez-Rodriguez J. Perturbation-response genes reveal signaling footprints in cancer gene expression. *Nat Commun.* 2018 Jan 2;9(1):20. doi: [10.1038/s41467-017-02391-6](https://doi.org/10.1038/s41467-017-02391-6). PMID: 29295995; PMCID: PMC5750219.

## 🔗 Cite This Repository

If you use the **data** or **code** from this repository in your work, please cite this repository:

> This repository accompanies a manuscript currently under peer review. Citation details will be updated upon publication.


